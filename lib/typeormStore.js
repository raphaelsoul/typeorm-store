(()=>{"use strict";var t={923:function(t,e,r){var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||i(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r(135),e)},135:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TypeormStore=void 0;const i=r(250),o=r(508);class s extends o.Store{constructor(t){if(super(t),this.all=t=>{this.repository.find().then((t=>t.map((t=>JSON.parse(t.data))))).then((e=>t(null,e))).catch((e=>t(e)))},this.destroy=(t,e)=>{this.repository.delete(t).then((()=>e&&e(null))).catch((t=>e&&e(t)))},this.clear=t=>{this.repository.clear().then((()=>t&&t(null))).catch((e=>t&&t(e)))},this.length=t=>{this.repository.count().then((e=>t(null,e))).catch((e=>t(e,0)))},this.get=(t,e)=>{this.repository.findOne({where:{id:t}}).then((t=>{if(!t)return e(null);const r=JSON.parse(t.data);e(null,r)})).catch((t=>e(t)))},this.set=(t,e,r)=>{let i;try{i=JSON.stringify(e)}catch(t){if(r)return r(t);throw t}const o=this.getTTL(e),s=Math.floor((new Date).getTime()/1e3)+o;this.repository.save({id:t,data:i,expiresAt:s}).then((()=>r&&r(null))).catch((t=>r&&r(t)))},this.touch=(t,e,r)=>{const i=this.getTTL(e),o=Math.floor((new Date).getTime()/1e3)+i;this.repository.update(t,{expiresAt:o}).then((()=>r&&r(null))).catch((t=>r&&r(t)))},this.clearExpiredSessions=t=>{const e=Math.round((new Date).getTime()/1e3);this.repository.delete({expiresAt:i.LessThan(e)}).then((()=>t&&t(null))).catch((e=>t&&t(e)))},this.setExpirationInterval=t=>{t=t||this.expirationInterval,this.clearExpirationInterval(),this.expirationIntervalId=setInterval(this.clearExpiredSessions,1e3*t)},this.clearExpirationInterval=()=>{this.expirationIntervalId&&clearInterval(this.expirationIntervalId),this.expirationIntervalId=void 0},this.getTTL=t=>this.ttl?this.ttl:t.cookie&&t.cookie.maxAge?Math.floor(t.cookie.maxAge/1e3):86400,!t.repository)throw new Error("The repository option is required");this.repository=t.repository,this.ttl=t.ttl,this.expirationInterval=t.expirationInterval||86400,(void 0===t.clearExpired||t.clearExpired)&&this.setExpirationInterval(this.expirationInterval)}}e.TypeormStore=s},508:t=>{t.exports=require("express-session")},250:t=>{t.exports=require("typeorm")}},e={},r=function r(i){var o=e[i];if(void 0!==o)return o.exports;var s=e[i]={exports:{}};return t[i].call(s.exports,s,s.exports,r),s.exports}(923);module.exports=r})();
//# sourceMappingURL=typeormStore.js.map